<!DOCTYPE html>
<html class="text-center sm:text-left h-full flex flex-col justify-center m-8 bg-back">
<head>
  <title>Sign Up</title>
  <!-- Include Cropper.js CSS -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.2/cropper.css"
  />
  <!-- Your existing CSS -->
  <link href="/stylesheets/main.css" rel="stylesheet">
</head>
<body class="h-full bg-back">
    <form action="/signup" method="post" enctype="multipart/form-data">
    <div class="space-y-12">
      <div class="border-b border-gray-900/10 pb-12">
        <h1 class="text-base font-semibold leading-7 text-gray-900">Profile</h1>
        <h2 class="mt-1 text-sm leading-6 text-gray-600">This information will be displayed publicly so be careful what you share.</h2>

        <div class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
          <!-- Username -->
          <div class="sm:col-span-4">
            <label for="username_in_req" class="block text-sm font-medium leading-6 text-gray-900">Username</label>
            <div class="mt-2">
              <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-maroon sm:max-w-md">
                <input type="text" name="username_in_req" id="username_in_req" autocomplete="username" class="block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" placeholder="janesmith">
              </div>
            </div>

            <!-- Password -->
            <label for="password" class="block text-sm font-medium leading-6 text-gray-900 mt-5">Password</label>
            <div class="mt-2">
              <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-maroon sm:max-w-md">
                <input type="password" name="password" id="password" autocomplete="password" class="block flex-1 border-0 bg-transparent py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6" placeholder="SecretPassword">
              </div>
            </div>
          </div>

          <!-- About -->
          <div class="col-span-full">
            <label for="about" class="block text-sm font-medium leading-6 text-gray-900 mt-5">About</label>
            <p class="mt-3 text-sm leading-6 text-gray-600">Write a few sentences about yourself.</p>
            <div class="mt-2">
              <textarea id="about" name="about" rows="3" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-maroon sm:text-sm sm:leading-6"></textarea>
            </div>
          </div>

          <!-- Profile Picture -->
          <div class="col-span-full">
            <label for="profile-picture" class="block text-sm font-medium leading-6 text-gray-900">Profile Picture</label>
            <p class="mt-2 text-sm text-gray-600">Upload your profile picture and crop it to your liking.</p>
            <div class="mt-2 flex flex-col items-center rounded-lg border border-dashed bg-gray-100 border-gray-900/25 px-6 py-10">
              <div class="text-center">
                <!-- Image preview area -->
                <div class="mb-4">
                  <img id="imagePreview" class="mx-auto h-64 w-64 object-cover rounded-full" src="" alt="Profile Picture Preview" style="display: none;">
                </div>
                <!-- Image upload and Crop Image button -->
                <div class="flex flex-col items-center">
                  <div class="flex text-sm leading-6 text-gray-600 justify-center">
                    <label for="file-upload" class="relative cursor-pointer rounded-md font-semibold text-maroon focus-within:outline-none focus-within:ring-2 focus-within:ring-maroon focus-within:ring-offset-2 hover:text-maroon-dark">
                      <span>Upload a file</span>
                      <input id="file-upload" name="file-upload" type="file" accept="image/*" class="sr-only">
                    </label>
                    <p class="pl-1">or drag and drop</p>
                  </div>
                  <p class="text-xs leading-5 text-gray-600">PNG, JPG, GIF up to 10MB</p>
                  <!-- Crop Image Button -->
                  <button
                    id="crop-button"
                    type="button"
                    class="mt-4 rounded-md bg-green-500 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-500"
                    style="display: none;"
                  >
                    Crop Image
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Personal Information -->
          <!-- First Name -->
          <div class="sm:col-span-3">
            <label for="first_name" class="block text-sm font-medium leading-6 text-gray-900">First name</label>
            <div class="mt-2">
              <input type="text" name="first_name" id="first_name" autocomplete="given-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-maroon sm:text-sm sm:leading-6">
            </div>
          </div>

          <!-- Last Name -->
          <div class="sm:col-span-3">
            <label for="last_name" class="block text-sm font-medium leading-6 text-gray-900">Last name</label>
            <div class="mt-2">
              <input type="text" name="last_name" id="last_name" autocomplete="family-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-maroon sm:text-sm sm:leading-6">
            </div>
          </div>

          <!-- Email Address -->
          <div class="sm:col-span-4">
            <label for="email" class="block text-sm font-medium leading-6 text-gray-900">Email address</label>
            <div class="mt-2">
              <input id="email" name="email" type="email" autocomplete="email" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-maroon sm:text-sm sm:leading-6">
            </div>
          </div>

          <!-- Gender -->
          <div class="sm:col-span-3">
            <label for="gender" class="block text-sm font-medium leading-6 text-gray-900">Gender</label>
            <div class="mt-2">
              <select id="gender" name="gender" autocomplete="gender-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <option>Male</option>
                <option>Female</option>
                <option>Non-Binary</option>
                <option>Prefer Not To Say</option>
              </select>
            </div>
          </div>

          <!-- Major -->
          <div class="sm:col-span-3">
            <label for="major" class="block text-sm font-medium leading-6 text-gray-900">Major</label>
            <div class="mt-2">
              <select id="major" name="major" autocomplete="major-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <!--Nate will put in list of majors here-->
                <option>Computer Science</option>
                <option>Math</option>
                <option>Physics</option>
                <option>Business</option>
                <option>Chemistry</option>
                <option>Building Construction</option>
                <option>CMDA</option>
                <option>English</option>
                <option>Philosophy</option>
                <option>Biology</option>
                <option>Entreprenuership</option>
                <option>Advertising</option>
                <option>Agricultural Technology</option>
                <option>Cognitive and Behavioral Neuroscience</option>
                <option>Biomedical Engineering</option>
                <option>Natural Resources Conservation</option>
                <option>Building Construction</option>
                <option>Natural Resources Conservation</option>
                <option>International Studies</option>
                <option>Secure Computing</option>
                <option>Wireless Communications and Signal Processing</option>
                <option>Theatre Arts</option>
              </select>
            </div>
          </div>

          <!-- Dorm -->
          <div class="sm:col-span-3">
            <label for="dorm" class="block text-sm font-medium leading-6 text-gray-900">Dorms</label>
            <div class="mt-2">
              <select id="dorm" name="dorm" autocomplete="dorm-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <option>Cochrane</option>
                    <option>West AJ</option>
                    <option>East AJ</option>
                    <option>Pritchard</option>
                    <option>Slusher</option>
                    <option>GLC at Donaldson Brown</option>
                    <option>O'Shaughnessy</option>
                    <option>Payne</option>
                    <option>Campbell</option>
                    <option>Hillcrest</option>
                    <option>Hoge</option>
                    <option>Peddrew-Yates</option>
                    <option>CID</option>
                    <option>Miles</option>
                    <option>Vawter</option>
                    <option>Off Campus</option>
              </select>
            </div>
          </div>

          <!-- Bedtime -->
          <div class="sm:col-span-3">
            <label for="bedtime" class="block text-sm font-medium leading-6 text-gray-900">Bedtime</label>
            <div class="mt-2">
              <select id="bedtime" name="bedtime" autocomplete="bedtime-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <option>Earlier than 10pm</option>
                    <option>10:00pm-12:00pm</option>
                    <option>12:01pm-2:00am</option>
                    <option>All nighters for the most part</option>
              </select>
            </div>
          </div>

          <!-- Cleanliness -->
          <div class="sm:col-span-3">
            <label for="clean" class="block text-sm font-medium leading-6 text-gray-900">Cleanliness</label>
            <div class="mt-2">
              <select id="clean" name="clean" autocomplete="clean-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <option>Super Clean, Neat, and Organized</option>
                    <option>Somewhat Clean and Neat</option>
                    <option>Tries to be clean and organized</option>
                    <option>Could care less about how the room</option>
              </select>
            </div>
          </div>

          <!-- Class Year -->
          <div class="sm:col-span-3">
            <label for="class_year" class="block text-sm font-medium leading-6 text-gray-900">Class</label>
            <div class="mt-2">
              <select id="class_year" name="class_year" autocomplete="class_year_name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <option>2025</option>
                <option>2026</option>
                <option>2027</option>
                <option>2028</option>
                <option>2029</option>
              </select>
            </div>
          </div>

          <!-- Preferred Atmosphere -->
          <div class="sm:col-span-3">
            <label for="atmosphere" class="block text-sm font-medium leading-6 text-gray-900">Preferred Atmosphere</label>
            <div class="mt-2">
              <select id="atmosphere" name="atmosphere" autocomplete="atmosphere-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-maroon sm:max-w-xs sm:text-sm sm:leading-6">
                <option>Quiet</option>
                <option>Mostly Quiet, a little background noise is okay</option>
                <option>Some noise in the background is preferred</option>
                <option>Loud music/other noises is completely fine</option>
              </select>
            </div>
          </div>
        </div> <!-- End of grid -->

        <!-- Submit Button at the end of the form -->
        <div class="mt-6 flex items-center justify-center gap-x-6">
          <button type="button" class="text-sm font-semibold leading-6 text-gray-900">Cancel</button>
          <button
            id="submit-button"
            type="submit"
            class="rounded-md bg-maroon px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-maroon-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-maroon"
          >
            Save
          </button>
        </div>
      </div> <!-- End of border-b -->
    </div> <!-- End of space-y-12 -->
  </form>

  <!-- Include Cropper.js JS -->
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.2/cropper.min.js"
  ></script>
  <script>
    let cropper;
    let croppedImageBlob = null;

    const fileInput = document.getElementById('file-upload');
    const imagePreview = document.getElementById('imagePreview');
    const cropButton = document.getElementById('crop-button');
    const submitButton = document.getElementById('submit-button');
    const form = document.querySelector('form');

    fileInput.addEventListener('change', function (e) {
      const files = e.target.files;
      if (files && files.length > 0) {
        const file = files[0];

        if (/^image\//.test(file.type)) {
          const reader = new FileReader();
          reader.onload = function () {
            imagePreview.src = reader.result;
            imagePreview.style.display = 'block';

            if (cropper) {
              cropper.destroy();
            }

            cropper = new Cropper(imagePreview, {
              aspectRatio: 1,
              viewMode: 1,
              autoCropArea: 1,
              responsive: true,
              movable: true,
              zoomable: true,
              rotatable: false,
              scalable: false,
              background: false,
              cropBoxResizable: true,
              minCropBoxWidth: 100,
              minCropBoxHeight: 100,
            });

            // Show the crop button
            cropButton.style.display = 'inline-block';
          };
          reader.readAsDataURL(file);
        } else {
          alert('Please select an image file.');
        }
      }
    });

    cropButton.addEventListener('click', function () {
  if (cropper) {
    cropper.getCroppedCanvas({
      width: 300,
      height: 300,
      fillColor: '#fff',
      imageSmoothingEnabled: true,
      imageSmoothingQuality: 'high',
    }).toBlob(function (blob) {
      // Create a new File object and set it to the file input
      const file = new File([blob], 'profile.jpg', { type: 'image/jpeg' });
      const dataTransfer = new DataTransfer();
      dataTransfer.items.add(file);
      fileInput.files = dataTransfer.files;

      // Update the image preview with the cropped image
      const croppedImageURL = URL.createObjectURL(blob);
      imagePreview.src = croppedImageURL;

      // Destroy the cropper
      cropper.destroy();
      cropper = null;

      // Hide the crop button
      cropButton.style.display = 'none';
    }, 'image/jpeg');
  } else {
    alert('Please upload and adjust your profile picture.');
  }
});
  </script>
</body>
</html>
